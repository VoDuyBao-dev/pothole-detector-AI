{% load static %}
<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ch·∫°y tr·ª±c ti·∫øp</title>
    <link rel="stylesheet" href="{% static 'my_app/css/live_detection.css' %}" />
    <link rel="stylesheet" href="{% static 'my_app/css/sidebar.css' %}" />
  </head>
  <body data-theme="light">
    <!-- Sidebar -->
    <aside class="sidebar">
      {% include 'my_app/menu.html' %}
    </aside>

    <!-- Main -->
    <main>
      <div class="tmp">
        <div class="video-container">
          <video id="cameraFeed" autoplay muted></video>
          <canvas id="overlay"></canvas>
        </div>
        <div class="info-panel">
          <h3>Th√¥ng tin ph√°t hi·ªán</h3>
          <div class="info-item">
            S·ªë ·ªï g√†: <span id="pothole-count">0</span>
          </div>
          <div class="info-item">
            ƒê·ªô ch√≠nh x√°c: <span id="confidence">-</span>
          </div>
          <div class="info-item">
            Di·ªán t√≠ch: <span id="area">-</span>
          </div>
          <div class="info-item">
            K√≠ch th∆∞·ªõc: <span id="size">-</span>
          </div>
          <div class="info-item">
            ƒê·ªô l·ªõn: <span id="level">-</span>
          </div>
          <div class="info-item">
            GPS: <span id="gps-status">Ch∆∞a b·∫≠t</span>
            <button class="btn btn-gps" id="gpsToggle" onclick="toggleGPS()">üìç B·∫≠t GPS</button>
          </div>
          <div class="info-item">
            Camera: <span id="camera-status">Ch∆∞a b·∫≠t</span>
            <button type="button" class="btn" id="cameraToggle" onclick="toggleCamera()">üì∑ B·∫≠t Camera</button>
          </div>
        </div>
      </div>
      <!-- IMAGE UPLOAD -->
      <div class="box">
        <h3>üñºÔ∏è Upload ·∫¢nh</h3>
        <form id="uploadForm" enctype="multipart/form-data">
          <input type="file" name="image" accept="image/*" />
          <button type="submit">Submit</button>
        </form>
        <div id="result" class="container"></div>
      </div>
    </main>

    <!-- Th√¥ng b√°o -->
    {% if messages %}
      <div style="position:fixed; top:20px; right:20px; z-index:9999;">
        {% for message in messages %}
          <div style="background-color:
            {% if 'error' in message.tags %}
               #e74c3c
            {% elif 'success' in message.tags %}
               #2ecc71
            {% else %}
               #f39c12
            {% endif %};
            color:white; padding:12px 20px; border-radius:8px; margin-bottom:10px;
            animation: fadeInOut 4s forwards;">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
    <script>
      const detect_image = "{% url 'detect_image' %}"
      const liveDetectionUrl = "{% url 'live_detection' %}"
    </script>
    <script src="{% static 'my_app/js/live_detection.js' %}"></script>
  </body>
</html>
